{"ast":null,"code":"import _slicedToArray from\"/Users/neo/Desktop/react/blog/blog-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{changeField,initializeForm,login}from'../../modules/auth';import AuthForm from'../../components/auth/AuthForm';import{check}from'../../modules/user';import{withRouter}from'react-router-dom';var LoginForm=function LoginForm(_ref){var history=_ref.history;var dispatch=useDispatch();var _useSelector=useSelector(function(_ref2){var auth=_ref2.auth,user=_ref2.user;return{form:auth.login,auth:auth.auth,authError:auth.authError,user:user.user};}),form=_useSelector.form,auth=_useSelector.auth,authError=_useSelector.authError,user=_useSelector.user;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var onChange=function onChange(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;dispatch(changeField({form:'login',key:name,value:value}));};var onSubmit=function onSubmit(e){e.preventDefault();var username=form.username,password=form.password;dispatch(login({username:username,password:password}));};// 컴포넌트가 처음 렌더링될 때 form을 초기화\nuseEffect(function(){dispatch(initializeForm('login'));},[dispatch]);useEffect(function(){if(authError){console.log('오류 발생');console.log(authError);setError('로그인 실패');return;}if(auth){console.log('login 성공');dispatch(check());}},[auth,authError,dispatch]);useEffect(function(){if(user){console.log('check API 성공');console.log(user);history.push('/');try{localStorage.setItem('user',JSON.stringify(user));}catch(e){console.log('LocalStorage is not working');}}},[user,history]);return React.createElement(AuthForm,{type:\"login\",form:form,onChange:onChange,onSubmit:onSubmit,error:error});};export default withRouter(LoginForm);","map":{"version":3,"sources":["/Users/neo/Desktop/react/blog/blog-frontend/src/containers/auth/LoginForm.js"],"names":["React","useEffect","useState","useDispatch","useSelector","changeField","initializeForm","login","AuthForm","check","withRouter","LoginForm","history","dispatch","auth","user","form","authError","error","setError","onChange","e","target","value","name","key","onSubmit","preventDefault","username","password","console","log","push","localStorage","setItem","JSON","stringify"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { changeField, initializeForm, login } from '../../modules/auth';\nimport AuthForm from '../../components/auth/AuthForm';\nimport { check } from '../../modules/user';\nimport { withRouter } from 'react-router-dom';\n\nconst LoginForm = ({ history }) => {\n  const dispatch = useDispatch();\n  const { form, auth, authError, user } = useSelector(({ auth, user }) => ({\n    form: auth.login,\n    auth: auth.auth,\n    authError: auth.authError,\n    user: user.user,\n  }));\n\n  const [error, setError] = useState(null);\n\n  const onChange = e => {\n    const { value, name } = e.target;\n    dispatch(changeField({ form: 'login', key: name, value }));\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n    const { username, password } = form;\n    dispatch(login({ username, password }));\n  };\n  // 컴포넌트가 처음 렌더링될 때 form을 초기화\n  useEffect(() => {\n    dispatch(initializeForm('login'));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (authError) {\n      console.log('오류 발생');\n      console.log(authError);\n      setError('로그인 실패');\n      return;\n    }\n\n    if (auth) {\n      console.log('login 성공');\n      dispatch(check());\n    }\n  }, [auth, authError, dispatch]);\n\n  useEffect(() => {\n    if (user) {\n      console.log('check API 성공');\n      console.log(user);\n      history.push('/');\n      try {\n        localStorage.setItem('user', JSON.stringify(user));\n      } catch (e) {\n        console.log('LocalStorage is not working');\n      }\n    }\n  }, [user, history]);\n\n  return (\n    <AuthForm\n      type=\"login\"\n      form={form}\n      onChange={onChange}\n      onSubmit={onSubmit}\n      error={error}\n    ></AuthForm>\n  );\n};\n\nexport default withRouter(LoginForm);\n"]},"metadata":{},"sourceType":"module"}