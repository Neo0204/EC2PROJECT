{"ast":null,"code":"import _slicedToArray from\"/Users/neo/Desktop/react/blog/blog-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{changeField,initializeForm,register}from'../../modules/auth';import AuthForm from'../../components/auth/AuthForm';import{check}from'../../modules/user';import{withRouter}from'react-router-dom';var RegisterForm=function RegisterForm(_ref){var history=_ref.history;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var dispatch=useDispatch();var _useSelector=useSelector(function(_ref2){var auth=_ref2.auth,user=_ref2.user;return{form:auth.register,auth:auth.auth,authError:auth.authError,user:user.user};}),form=_useSelector.form,auth=_useSelector.auth,authError=_useSelector.authError,user=_useSelector.user;var onChange=function onChange(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;dispatch(changeField({form:'register',key:name,value:value}));};var onSubmit=function onSubmit(e){e.preventDefault();var username=form.username,password=form.password,passwordConfirm=form.passwordConfirm;if([username,password,passwordConfirm].includes('')){setError('빈 칸을 모두 입력하세요');return;}if(password!==passwordConfirm){setError('비밀번호가 일치하지 않습니다.');dispatch(changeField({form:'register',key:'password',value:''}));dispatch(changeField({form:'register',key:'passwordConfirm',value:''}));return;}dispatch(register({username:username,password:password}));};// 컴포넌트가 처음 렌더링될 때 form을 초기화\nuseEffect(function(){dispatch(initializeForm('register'));},[dispatch]);useEffect(function(){if(authError){if(authError.response.status=409){setError('이미 존재하는 계정명입니다.');return;}console.log('회원 가입 실패');return;}if(auth){console.log('회원가입 성공');console.log(auth);dispatch(check());}},[auth,authError,dispatch]);useEffect(function(){if(user){console.log('check API 성공');console.log(user);history.push('/');try{localStorage.setItem('user',JSON.stringify(user));}catch(e){console.log('LocalStorage is not working');}}},[user,history]);return React.createElement(AuthForm,{type:\"register\",form:form,onChange:onChange,onSubmit:onSubmit,error:error});};export default withRouter(RegisterForm);","map":{"version":3,"sources":["/Users/neo/Desktop/react/blog/blog-frontend/src/containers/auth/RegisterForm.js"],"names":["React","useEffect","useState","useDispatch","useSelector","changeField","initializeForm","register","AuthForm","check","withRouter","RegisterForm","history","error","setError","dispatch","auth","user","form","authError","onChange","e","target","value","name","key","onSubmit","preventDefault","username","password","passwordConfirm","includes","response","status","console","log","push","localStorage","setItem","JSON","stringify"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { changeField, initializeForm, register } from '../../modules/auth';\nimport AuthForm from '../../components/auth/AuthForm';\nimport { check } from '../../modules/user';\nimport { withRouter } from 'react-router-dom';\n\nconst RegisterForm = ({ history }) => {\n  const [error, setError] = useState(null);\n  const dispatch = useDispatch();\n  const { form, auth, authError, user } = useSelector(({ auth, user }) => ({\n    form: auth.register,\n    auth: auth.auth,\n    authError: auth.authError,\n    user: user.user,\n  }));\n\n  const onChange = e => {\n    const { value, name } = e.target;\n    dispatch(changeField({ form: 'register', key: name, value }));\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n    const { username, password, passwordConfirm } = form;\n    if ([username, password, passwordConfirm].includes('')) {\n      setError('빈 칸을 모두 입력하세요');\n      return;\n    }\n    if (password !== passwordConfirm) {\n      setError('비밀번호가 일치하지 않습니다.');\n      dispatch(changeField({ form: 'register', key: 'password', value: '' }));\n      dispatch(\n        changeField({ form: 'register', key: 'passwordConfirm', value: '' }),\n      );\n      return;\n    }\n    dispatch(register({ username, password }));\n  };\n  // 컴포넌트가 처음 렌더링될 때 form을 초기화\n  useEffect(() => {\n    dispatch(initializeForm('register'));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (authError) {\n      if ((authError.response.status = 409)) {\n        setError('이미 존재하는 계정명입니다.');\n        return;\n      }\n      console.log('회원 가입 실패');\n\n      return;\n    }\n\n    if (auth) {\n      console.log('회원가입 성공');\n      console.log(auth);\n      dispatch(check());\n    }\n  }, [auth, authError, dispatch]);\n\n  useEffect(() => {\n    if (user) {\n      console.log('check API 성공');\n      console.log(user);\n      history.push('/');\n      try {\n        localStorage.setItem('user', JSON.stringify(user));\n      } catch (e) {\n        console.log('LocalStorage is not working');\n      }\n    }\n  }, [user, history]);\n\n  return (\n    <AuthForm\n      type=\"register\"\n      form={form}\n      onChange={onChange}\n      onSubmit={onSubmit}\n      error={error}\n    ></AuthForm>\n  );\n};\n\nexport default withRouter(RegisterForm);\n"]},"metadata":{},"sourceType":"module"}